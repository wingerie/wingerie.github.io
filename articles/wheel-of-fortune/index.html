<!doctype html>

<html lang="ru">

<head>
    <meta charset="utf-8">

    <title>The HTML5 Herald</title>

    <link rel="stylesheet" href="../../css.css">
    <link href="https://fonts.googleapis.com/css?family=Rubik:400,400i,500,500i&subset=cyrillic" rel="stylesheet">

    <script src="../../js.js"></script>

</head>

<body>
    <div class="lightbox lightbox_hidden" id="lightbox">
        <button class="close_lightbox interactable" onclick="close_lightbox()">╳</button>
    </div>
    <div class="article_wrapper">
        <section>
            <h1>Управление Колесом Фортуны на&nbsp;Фогейме</h1>
        </section>
        <section class="terms">
            <details open>
                <summary class="interactable">Несколько терминов</summary>
                <dl>
                    <dt>Кэрриер</dt>
                    <dd>Наша внутренняя админка для платформы Фогейма</dd>

                    <dt>Колесо Фортуны</dt>
                    <dd>Дополнительная монетизационная механика одной из&nbsp;игр на&nbsp;платформе в&nbsp;виде мини-игры в&nbsp;десктопном приложении</dd>

                    <dt>Колесо</dt>
                    <dd>Условное название для интерфейса управления Колесом Фортуны в&nbsp;Кэрриере</dd>

                    <dt>Вебшоп</dt>
                    <dd>Один из&nbsp;микросервисов платформы, отвечающий за&nbsp;хранение данных о&nbsp;товарах на&nbsp;платформе и&nbsp;их&nbsp;доставку игрокам</dd>
                </dl>
            </details>
        </section>
        <section>
            <h2>Вводные</h2>
            <p>
                Колесо Фортуны&nbsp;&mdash; дополнительная монетизационная механика одной из&nbsp;игр на&nbsp;платформе. Фактически это <a href="https://ru.wikipedia.org/wiki/%D0%9B%D1%83%D1%82%D0%B1%D0%BE%D0%BA%D1%81">лутбокс</a>&nbsp;&mdash; игрок платит за&nbsp;случайный предмет из&nbsp;призового пула. Управлением лутбокса занимаются игровые команды. Их&nbsp;задача&nbsp;&mdash; составить призовой пул, посчитать экономику, подготовить товары, шансы выпадения предметов, описания и&nbsp;так далее.
            </p>
            <p>
                Старый процесс работы с&nbsp;колесом включал в&nbsp;себя большое количество шагов, а&nbsp;так&nbsp;же был строг к&nbsp;ошибкам в&nbsp;процессе:
            </p>
            <img src="images/1-old-scheme.svg" class="extra_width contain">
            <ol>
                <li>Формируется список предметов</li>
                <li>
                    Заводится таблица в&nbsp;Google Sheets/Libra Office, которая содержит список предметов. Для каждого предмета указывается:
                    <ul>
                        <li>Название</li>
                        <li>Описание</li>
                        <li>Особенности передачи предмета внутри игры</li>
                        <li>Slug предмета из&nbsp;вебшопа</li>
                        <li>Количество получаемых предметов при выигрыше</li>
                        <li>Шанс&nbsp;0...1</li>
                        <li>Булевый параметр, отмечающий главные призы</li>
                        <li>Булевый параметр, отмечающий предметы, требующие ручного начисления сотрудником</li>
                    </ul>
                </li>
                <li>После проверки, данные таблицы руками переносятся в&nbsp;специальный инструмент, написаный бэкэндерами. В&nbsp;инструменте так&nbsp;же настраиваются дополнительные параметры Колеса, такие как видимость игрокам, стоимость игры, количество оборотов и&nbsp;так далее.</li>
                <li>Настроенное колесо публикуется на&nbsp;платформе и&nbsp;доступно игрокам</li>
            </ol>
            <p>
                В&nbsp;такой системе я&nbsp;вижу несколько недостатков:
            </p>
            <ol>
                <li><i>Много ручного копирования</i>, как на&nbsp;этапе формирования списка товаров, так и&nbsp;при переносе во&nbsp;внутренний инструмент. Во-первых, это долго, во-вторых, даёт множество возможностей для ошибки.</li>
                <li><i>Дублируется функциональность другого сервиса&nbsp;&mdash; Вебшопа.</i> Если находятся ошибки в&nbsp;описании товара, то&nbsp;не&nbsp;всегда очевидно, где искать проблему&nbsp;&mdash; в&nbsp;настройках Колеса, либо в&nbsp;Вебшопе.</li>
                <li><i>Плохой интерфейс внутреннего инструмента:</i>
                    <ul>
                        <li>Сложно проверить правильность Колеса до&nbsp;публикации</li>
                        <li>Сложно найти и&nbsp;отредактировать данные отдельного предмета</li>
                    </ul>
                </li>
                <li><i>Для связывания призов и&nbsp;предметов из&nbsp;Вебшопа команде приходилось использовать технические slug&rsquo;и</i>, которые сложнее проверить быстро.</li>
            </ol>
        </section>
        <section>
            <h2>Требования</h2>
            <p>
                Изначально задача состояла в&nbsp;поддержке импорта таблицы призов из&nbsp;Google Sheets/Libra Office и&nbsp;отображении таблицы в&nbsp;Кэрриере. Это было сделано без моего участия. Однако оказалось, что, во-первых, таблица содержит только данные о&nbsp;призах, но&nbsp;не&nbsp;параметры самого Колеса, и&nbsp;обойтись только импортом не&nbsp;получится. Во-вторых, в&nbsp;процессе работы, у&nbsp;продакта и&nbsp;разработчика появилось желание не&nbsp;только отобразить список призов, но&nbsp;и&nbsp;давать их&nbsp;редактировать из&nbsp;Кэрриера. После этого они обратились ко&nbsp;мне.
            </p>
        </section>
        <section>
            <h2>Этапы работы</h2>
            <p>
                Процесс работы можно разделить на&nbsp;несколько этапов:
            </p>
            <ol>
                <li>Исследование текущего процесса работы игровой команды над Колесом, изучение api, поиск проблемных мест в&nbsp;текущем решении</li>
                <li>Формулирование нового решения, упрощение лишнего, первые макеты, тестирование на&nbsp;игровых командах</li>
                <li>Правки, сборка первой версии вместе с&nbsp;разработчиком, тестирование сборки на&nbsp;игровых командах</li>
                <li>Правки по&nbsp;результатам тестирования и&nbsp;дополнительные улучшения в&nbsp;ux&nbsp;вместе с&nbsp;разработчиком</li>
            </ol>
        </section>
        <section>
            <h2>Улучшения</h2>
            <ol>
                <li>
                    <h3>Упрощения в&nbsp;структуре данных</h3>
                    <p>
                        Первое, что я&nbsp;сделал&nbsp;&mdash; постарался отделить настройку Колеса от&nbsp;товаров:
                    </p>
                    <p>
                        Теперь Колесо лишь содержит ссылки на&nbsp;товары из&nbsp;призового пула, и&nbsp;управляет только сущностями Колеса&nbsp;&mdash; шансами получения, количеством, важностью приза и&nbsp;так далее.
                    </p>
                    <p>
                        Всё, что отностися к&nbsp;сути товара как самостоятельной сущности осталось целиком на&nbsp;стороне специального сервиса&nbsp;&mdash; Вебшопа. Оттуда подтягиваются картинки, названия и&nbsp;описания товаров. В&nbsp;будущем туда должны переехать и&nbsp;другие сущности, относящиеся к&nbsp;товару, такие как особенности передачи между игроками и&nbsp;ручная выдача игровой командой.
                    </p>
                    <p>
                        Технические параметры, которые мы&nbsp;можем генерировать автоматом больше не&nbsp;являются обязательными для заполнения командой&nbsp;&mdash; slug и&nbsp;ID.
                    </p>
                </li>
                <li>
                    <h3>Cтруктура страницы Колеса</h3>
                    <p>
                        Я&nbsp;чётко отделил три сущности на&nbsp;странице Колеса:
                    </p>
                    <ol>
                        <li>Шапка с&nbsp;метаинформацией о&nbsp;Колесе&nbsp;&mdash; название, slug, ID, видимостью игрокам</li>
                        <li>Настройки игровой составляющей&nbsp;&mdash; версии прокручивания, их&nbsp;статусы, стоимости и&nbsp;так далее</li>
                        <li>Список призов</li>
                    </ol>
                    <img src="images/2-wheel-screen@2x.png" class="extra_width contain interactable" onclick="lightbox_this(this)">
                </li>
                <li>
                    <h3>Облегчённое редактирование приза</h3>
                    <p>
                        Раньше, для добавления товара в&nbsp;Колесо, надо было найти предмет в&nbsp;Вебшопе и&nbsp;скопировать оттуда руками в&nbsp;таблицу в&nbsp;Google Sheets:
                    </p>
                    <ul>
                        <li>slug нужной версии товара</li>
                        <li>Название</li>
                        <li>Описание</li>
                    </ul>
                    <p>
                        Здесь я&nbsp;видел две проблемы:
                    </p>
                    <ol>
                        <li>
                            Slug, несмотря на&nbsp;большую человекочитаемость чем, скажем, id&nbsp;товара, всё равно недостаточно легко воспринимаем:
                            <ul>
                                <li>Slug может быть очень длинным, гораздо длиннее названия товара</li>
                                <li>Название конкретной версии товара докидывается в&nbsp;самый конец slug</li>
                                <li>Slug может использовать внутренние технические термины, которые не&nbsp;всегда однозначно понятны из&nbsp;фактического названия товара</li>
                                <li>Slug исторически придумывался руками, и&nbsp;содержал переводы русских слов. Не&nbsp;все участники игровых команд знают английский</li>
                            </ul>
                        </li>
                        <li>
                            Название и&nbsp;описание копируются руками из&nbsp;Вебшопа, что может привести к&nbsp;рассинхрону информации между Вебшопом и&nbsp;Колесом.
                        </li>
                    </ol>
                    <p>Вместо этого, мы&nbsp;сделали поиск по&nbsp;товарам в&nbsp;Вебшопе с&nbsp;садджестом и&nbsp;стали автоматом забирать оттуда названия и&nbsp;описания товаров.</p>
                    <p>Так&nbsp;же, раньше особенности доставки товара каждый раз нужно было писать с&nbsp;нуля. Я&nbsp;попросил игровые команды скинуть мне примеры Колёс, и&nbsp;нашёл в&nbsp;них 4&nbsp;часто повторяющихся описания, которые теперь можно выбрать по-дефолту. На&nbsp;всякий случай есть возможность добавить кастомное описание особенностей передачи товара.</p>
                    <p>Для большей наглядности я&nbsp;добавил сниппет товара с&nbsp;пользовательской страницы колеса, чтоб команда сразу могла понять, что увидит конечный пользователь.</p>
                    <div class="two_column extra_width">
                        <img src="images/3-item-edit@2x.png" class="contain interactable" onclick="lightbox_this(this)">
                        <img src="images/4-item-edit-suggest@2x.png" class="contain interactable" onclick="lightbox_this(this)">
                    </div>
                </li>
                <li>
                    <h3>Прочие улучшения</h3>
                    <p>Так&nbsp;же было сделано несоклько мелких улучшений, типа изменения порядка призов драг-н-дропом, автопроверка количества товаров и&nbsp;суммарного шанса выпадения, можно быстрее выключить/выключить Колесо, отредактировать версии Колеса и&nbsp;так далее.</p>
                </li>
            </ol>
        </section>
        <section>
            <h2>Итоговый результат</h2>
            <video controls class="extra_width interactable">
                <source src="images/5-wheel-end.webm"
                        type="video/webm">
                Здесь должно быть .webm видео с&nbsp;итоговым результатом.
            </video>
        </section>
    </div>
</body>

</html>